<!DOCTYPE html>
<html>
% from helper import browser
% from helper.url import Url
<head>
    <meta charset="utf-8">

    <title>{{title + ' - ' if title else ''}}NomNomNom</title>

    <meta name="description" content="A simple Python and SQLite based recipe manager.">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Favicon -->
    <link rel="apple-touch-icon" href="{{Url.from_img('img/apple-touch-icon.png')}}">
    <link rel="icon" href="{{Url.from_img('img/favicon.png')}}">
    <!--[if IE]><link rel="shortcut icon" href="{{Url.from_img('img/favicon.ico')}}"><![endif]-->
    
    <!-- Framework, Widgets... -->
    <link rel="stylesheet" href="{{Url.from_css('normalize.css')}}">
    <link rel="stylesheet" href="{{Url.from_css('gridism.css')}}">
    <link rel="stylesheet" href="{{Url.from_css('chosen.min.css')}}">
     <link rel="stylesheet" href="{{Url.from_css('jquery.fancybox.css')}}">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans">

    <!-- Custom -->
    <link rel="stylesheet/less" type="text/css" href="{{Url.from_css('main.less')}}">
    % if browser.Browser.is_mobile():
        <link rel="stylesheet/less" type="text/css" href="{{Url.from_css('mobile.less')}}">
    % end

    <!-- LESS -->
    <script>
        less = {
            env: "development",
            functions: {},
            dumpLineNumbers: "comments",
        };
    </script>
    <script src="{{Url.from_js('less.min.js')}}"></script>
</head>
<body>
    <div class="wrap wider">
        <div class="only-screen">
            <div id="page-top" class="grid">
                <div id="header" class="unit w-1-3">
                    <h1><a href="{{Url.from_path([])}}">NomNomNom</a></h1>
                </div>

                <div class="unit w-2-3">
                    <ul id="action-nav">
                        <li><a href="{{Url.from_path(['search'])}}">Search</a></li>
                        <li><a href="{{Url.from_path(['manage', 'recipe'])}}">New Recipe</a></li>
                        % if defined('edit_recipe') and edit_recipe:
                            <li><a href="{{Url.from_path(['manage', 'recipe', str(recipe.id)])}}">Edit Recipe</a></li>
                        % end
                        <li><a href="{{Url.from_path(['manage', 'categories'])}}">Manage Categories</a></li>
                        <li><a href="{{Url.from_path(['manage', 'tags'])}}">Manage Tags</a></li>
                    </ul>
                </div>
            </div>

            <div class="grid">
                <div class="unit w-1-1">
                    <ul id="category-nav">
                        % for category in categories:
                            <li><a href="{{Url.from_category(category)}}">{{category.name}}</a></li>
                        % end
                    </ul>
                </div>
            </div>

            % if defined('hints') and hints:
                <div id="hints" class="grid">
                    <div class="unit w-1-1">
                        <ul>
                            % for hint in hints:
                                <li>{{hint.text}}</li>
                            % end
                        </ul>
                    </div>
                </div>
            % end
        </div>

        <div class="grid">
            <div id="{{id}}" class="unit w-1-1">
                % include
            </div>
        </div>
    </div>

    <!-- jQuery -->
    <script src="{{Url.from_js('jquery.min.js')}}"></script>
    <script src="{{Url.from_js('chosen.jquery.min.js')}}"></script>
    <script src="{{Url.from_js('jquery.autocomplete.min.js')}}"></script>
    <script src="{{Url.from_js('jquery.fancybox.pack.js')}}"></script>

    <!-- Custom -->
    <script src="{{Url.from_js('main.js')}}"></script>
    % if id == 'search':
        <script>
            $('#search-text').autocomplete(
            {
                autoSelectFirst: true,
                delimiter: /(\s+|:)/,
                lookup: [
                    // Whoosh
                    'category:', 'description:', 'info:', 'ingredients:', 'tags:',
                    'title:', 'rated:no ', 'rated:yes ', 'AND ', 'OR ', 'NOT ',
                    // Category
                    % for category in categories:
                        '{{category.name}} ',
                    % end
                    // Tags
                    % for tag in tags:
                        '{{tag.name}} ',
                        % for synonym in tag.synonyms:
                            '{{synonym.name}} ',
                        % end
                    % end
                ],
                onSelect: function(suggestion) {
                    var search = $('#search-text');
                    var encoded = search.val();
                    search.val( $('<div/>').html(encoded).text() );
                },
                tabDisabled: true
            });
        </script>
    % end
</body>
</html>